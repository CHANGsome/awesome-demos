{"version":3,"sources":["components/VoiceControl/index.module.scss","resources/SomeoneYouLoved.mp3","img/voice.svg","components/VoiceControl/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["module","exports","dragging","circles","lastDeg","lastX","VoiceControl","props","size","volume","onVolumeChange","handlerRef","useRef","volumeRef","useState","rotateDeg","setRotateDeg","handleMove","useCallback","e","current","offsetLeft","offsetTop","offsetHeight","transformOriginX","transformOriginY","det_x","clientX","det_y","clientY","deg","Math","atan","PI","useEffect","document","onmousemove","onmouseup","textContent","className","styles","container","style","fontSize","top","ref","handler","transform","onMouseDown","head","axis","anchor","voiceContainer","voiceDisplay","voiceNumber","voiceFill","borderBottomWidth","src","voice","alt","voiceLogo","bottom","music","require","App","audioRef","currentVolume","controls","default","type","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.dff8492b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"VoiceControl_container__1O57l\",\"top\":\"VoiceControl_top__2YrSR\",\"handler\":\"VoiceControl_handler__TEZT_\",\"anchor\":\"VoiceControl_anchor__2FQnK\",\"head\":\"VoiceControl_head__-thKl\",\"headIcon\":\"VoiceControl_headIcon__2e1Pm\",\"axis\":\"VoiceControl_axis__3Rojz\",\"voiceContainer\":\"VoiceControl_voiceContainer__2UMIo\",\"voiceDisplay\":\"VoiceControl_voiceDisplay__14lGb\",\"voiceNumber\":\"VoiceControl_voiceNumber__2jJ0y\",\"voiceFill\":\"VoiceControl_voiceFill__CU_vX\",\"voiceLogo\":\"VoiceControl_voiceLogo__18jv4\",\"bottom\":\"VoiceControl_bottom__RF4y-\"};","export default __webpack_public_path__ + \"static/media/SomeoneYouLoved.120e574b.mp3\";","export default __webpack_public_path__ + \"static/media/voice.9d1147f6.svg\";","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport styles from './index.module.scss';\nimport voice from 'img/voice.svg';\n\nlet dragging = false;\nlet circles = 0;\nlet lastDeg = 0;\nlet lastX = 0;\n\ntype PropsType = {\n  size?: number;\n  volume?: number;\n  onVolumeChange?: (currentVolume: number) => void;\n};\nconst VoiceControl: React.FC<PropsType> = (props) => {\n  const { size = 10, volume = 10, onVolumeChange } = props;\n  const handlerRef = useRef<HTMLDivElement>(null);\n  const volumeRef = useRef<HTMLDivElement>(null);\n  const [rotateDeg, setRotateDeg] = useState<number>(0);\n\n  const handleMove = useCallback(\n    (e: MouseEvent) => {\n      if (!dragging || !handlerRef.current) {\n        return;\n      }\n      let [transformOriginX, transformOriginY] = [\n        handlerRef.current.offsetLeft,\n        handlerRef.current.offsetTop + handlerRef.current.offsetHeight,\n      ];\n      let [det_x, det_y] = [\n        e.clientX - transformOriginX,\n        transformOriginY - e.clientY,\n      ];\n      let deg = 0;\n      if (det_y > 0) {\n        // 第一、四象限\n        // 根据tan值计算角度\n        deg = Math.atan(det_x / det_y) / (Math.PI / 180);\n        if (det_x < 0) {\n          deg += 360;\n        }\n      } else if (det_y === 0) {\n        // x轴\n        if (det_x > 0) {\n          deg = 90;\n        } else if (det_x < 0) {\n          deg = 270;\n        }\n      } else if (det_y < 0) {\n        //第二、三象限，都是正值90～270度\n        deg = Math.atan(det_x / det_y) / (Math.PI / 180) + 180;\n        if (det_x < 0) {\n        }\n      }\n      if (det_y > 0) {\n        if (e.clientX > lastX && deg < lastDeg && deg < 10 && circles < 100) {\n          // 其实判断deg===0的时候直接加1最好，但是因为转动太快有掉帧的问题，有些坐标和角度获取不到\n          // 加1的条件：1.deg 从 359->0: 在顺时针旋转的时候因为deg一直时递增的（0增到359+），所以当前deg小于上一次deg的时候就是从第四象限跳到第一象限的时候\n          //          2.顺时针旋转：\n          //          （1）当前X坐标大于上一次坐标（不一定能满足，因为mousemove绑定在document上，有时候拖拽鼠标会往回移动）\n          //          （2）所以加一个条件一起判断是否顺时针：deg < 10，只在离y正半轴10度的地方判断\n          circles++;\n        } else if (\n          e.clientX < lastX &&\n          deg > lastDeg &&\n          360 - deg < 10 &&\n          circles > 0\n        ) {\n          // 减1的条件：1. 逆时针旋转；2.从第1象限跳到第四象限的那个时候\n          circles--;\n        }\n      }\n      onVolumeChange && onVolumeChange(circles / 100);\n      setRotateDeg(deg);\n      lastDeg = deg;\n      lastX = e.clientX;\n    },\n    [onVolumeChange]\n  );\n  useEffect(() => {\n    // 将mousemove和mouseup绑定在document上，这样拖拽元素时鼠标飞出去事件也不会丢失\n    document.onmousemove = handleMove; // 鼠标移动\n    document.onmouseup = () => (dragging = false); // 鼠标抬起\n\n    return () => {\n      document.onmousemove = null;\n      document.onmouseup = null;\n    };\n  }, [handleMove]);\n\n  useEffect(() => {\n    if (!volumeRef.current) {\n      return;\n    }\n    volumeRef.current.textContent = volume + '';\n    circles = 10;\n  }, [volume]);\n\n  return (\n    <div className={styles.container} style={{ fontSize: `${size}px` }}>\n      <div className={styles.top}>\n        <div\n          ref={handlerRef}\n          className={styles.handler}\n          style={{ transform: `rotate(${rotateDeg}deg)` }}\n          onMouseDown={() => (dragging = true)} // 鼠标按下\n        >\n          <div className={styles.head}>\n            {/* <img\n              src={require('img/Jennie2.jpg').default}\n              alt=\"head\"\n              className={styles.headIcon}\n            /> */}\n          </div>\n          <div className={styles.axis}></div>\n          <div className={styles.anchor}></div>\n        </div>\n        <div className={styles.voiceContainer}>\n          <div className={styles.voiceDisplay}>\n            <div className={styles.voiceNumber} ref={volumeRef}>\n              {circles}\n            </div>\n            <div\n              className={styles.voiceFill}\n              style={\n                volume && !circles\n                  ? { borderBottomWidth: `${size * 0.14 * volume}px` }\n                  : { borderBottomWidth: `${size * 0.14 * circles}px` }\n              }\n            ></div>\n          </div>\n          <img src={voice} alt=\"voice\" className={styles.voiceLogo} />\n        </div>\n      </div>\n\n      <div className={styles.bottom}></div>\n    </div>\n  );\n};\n\nexport default VoiceControl;\n","import React, { useEffect, useRef } from 'react';\nimport InvoiceControl from 'components/VoiceControl';\nlet music = require('./resources/SomeoneYouLoved.mp3');\n\nfunction App() {\n  const audioRef = useRef<HTMLAudioElement>(null);\n  useEffect(() => {\n    if (!audioRef.current) {\n      return;\n    }\n    audioRef.current.volume = 0;\n  }, []);\n  return (\n    <div className=\"App\">\n      <InvoiceControl\n        volume={10}\n        size={3}\n        onVolumeChange={(currentVolume: number) => {\n          if (!audioRef.current) {\n            return;\n          }\n          audioRef.current.volume = currentVolume;\n        }}\n      />\n\n      <audio controls ref={audioRef}>\n        <source src={music.default} type=\"audio/mpeg\"></source>\n        Your browser does not support the audio element.\n      </audio>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\nreportWebVitals();\n"],"sourceRoot":""}